swagger: '2.0'
schemes:
  - https
consumes:
  - application/json
produces:
  - application/json
security:
  - JWT: []
info:
  description: An API for interacting with data from Xpnase's Expander product.
  title: Expander API - Entities
  version: 1.0.0
  termsOfService: https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/legal/palo-alto-networks-end-user-license-agreement-eula.pdf
  contact:
    name: API Support
    url: https://docs.paloaltonetworks.com/cortex/cortex-xpanse/cortex-xpanse-user-guide/apis-and-integrations-main/expander-apis-and-integrations/expander-apis.html#expander-apis
    email: expanse-support@paloaltonetworks.com
securityDefinitions:
  JWT:
    description: 'For accessing the API a valid JWT token must be included in every query in the ''Authorization'' header. A valid JWT token is generated by the API and returned via the /IdToken/ route. The value for this header should be `JWT <token>`, where the token is the base64-encoded JSON Web Token. Example: `Authorization: JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`'
    type: apiKey
    name: Authorization
    in: header
basePath: /api/v1
paths:
  /IdToken/:
    get:
      summary: Get ID token
      description: Returns the ID token to be used with the other api endpoints as the API token.
      security: []
      parameters:
        - name: Authorization
          in: header
          description: 'Expanse-provided refresh token to be passed in Authentication header. Value must be prefixed with `Bearer`. Example: `Authorization: Bearer {your refresh token}`'
          required: true
          type: string
      responses:
        '200':
          description: ID token
          schema:
            type: object
            required:
              - token
            properties:
              token:
                type: string
  /Entity/:
    get:
      summary: List Business Units
      description: Returns the list of Business Units to which the authenticated user has access. Fetching IP Ranges from this endpoint is now deprecated and may return incorrect data.
      parameters:
        - name: name
          in: query
          required: false
          type: string
          description: Find an business unit by the given name
        - name: parent
          in: query
          required: false
          type: string
          format: uuid
          description: Find business units with the given parent Entity
        - name: has_parent
          in: query
          required: false
          type: string
          enum:
            - 'True'
            - 'False'
          description: Find business units that either have or do not have parents
      responses:
        '200':
          description: Business Unit list
          schema:
            type: array
            items:
              $ref: '#/definitions/Entity'
  /Entity/{entityId}/:
    get:
      summary: Business Unit Details
      description: Returns the details for a given business unit. Fetching IP Ranges from this endpoint is now deprecated and may return incorrect data.
      parameters:
        - name: entityId
          in: path
          required: true
          type: string
          format: uuid
          description: ID for given Entity
      responses:
        '200':
          description: Business Unit details
          schema:
            $ref: '#/definitions/Entity'

definitions:
  Entity:
    type: object
    properties:
      id:
        type: string
        format: uuid
      name:
        type: string
      parent:
        type: string
        format: uuid
        description: ID of parent Entity (may be null)
      resources:
        type: object
        description: A map of available asset types alongside the URL for fetching assets of that type for the given Entity
